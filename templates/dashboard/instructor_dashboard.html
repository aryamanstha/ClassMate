{% extends "base.html" %}
{% block title %}Instructor Dashboard{% endblock %}

{% block content %}

<h2 class="fw-bold mb-4">
    <i class="bi bi-person-badge"></i> Instructor Dashboard
</h2>

<!-- Instructor Info -->
<div class="card mb-4 shadow-sm">
    <div class="card-body">
        <h4 class="fw-bold">{{ instructor.name }}</h4>

        <p class="text-muted mb-1">
            <i class="bi bi-envelope"></i> {{ instructor.email }}
        </p>

        <p class="text-muted mb-1">
            <i class="bi bi-telephone"></i> {{ instructor.phone }}
        </p>

        <p class="text-muted mb-0">
            <i class="bi bi-building"></i> Department: {{ instructor.department }}
        </p>
    </div>
</div>

<!-- Sections -->
<h4 class="fw-bold mb-3">My Sections</h4>

{% if sections %}
<div class="accordion" id="sectionAccordion">

    {% for section in sections %}
    <div class="accordion-item shadow-sm mb-3">
        <h2 class="accordion-header">
            <button class="accordion-button collapsed"
                    data-bs-toggle="collapse"
                    data-bs-target="#sec{{ section.section_id }}">
                {{ section.course.course_name }} — {{ section.semester }} {{ section.year }}
            </button>
        </h2>

        <div id="sec{{ section.section_id }}" class="accordion-collapse collapse">
            <div class="accordion-body">

                <p class="mb-1">
                    <strong>Section ID:</strong> {{ section.section_id }}
                </p>
                <p class="mb-3">
                    <strong>Course:</strong> {{ section.course.course_id }} — {{ section.course.course_name }}
                </p>

                <h6 class="fw-bold">Assigned Textbooks</h6>

                {% if section.sectiontextbook_set.all %}
                <ul class="list-group mb-2">
                    {% for st in section.sectiontextbook_set.all %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span>
                            <strong>{{ st.textbook.title }}</strong><br>
                            <small class="text-muted">{{ st.requirement_type }}</small>
                        </span>

                        <a href="{% url 'edit_section_textbooks' section.section_id %}"
                           class="btn btn-sm btn-outline-primary">
                            Edit
                        </a>
                    </li>
                    {% endfor %}
                </ul>
                {% else %}
                    <p class="text-muted">No textbooks assigned.</p>
                {% endif %}

                <a href="{% url 'edit_section_textbooks' section.section_id %}"
                   class="btn btn-success btn-sm mt-2">
                    + Add / Modify Textbooks
                </a>

            </div>
        </div>
    </div>
    {% endfor %}

</div>
{% else %}
<p class="text-muted">No sections assigned to you.</p>
{% endif %}

{% endblock %}
